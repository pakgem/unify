!function(e,t){"use strict";function n(e){const t=e.getAttribute("aria-label");if(t)return t.trim();const n=e.querySelector(".fw-500"),o=n?n.textContent:e.textContent;return"string"==typeof o?o.trim():""}function o(e){if(!e||"string"!=typeof e)return null;const t=e.match(/(?:youtube\.com\/watch\?v=|youtube\.com\/embed\/|youtu\.be\/)([a-zA-Z0-9_-]{6,})/);return t?t[1]:null}function r(t,n){const o=t.activeSession;if(!o||o.ended)return;o.ended=!0,o.progressTimer&&(e.clearInterval(o.progressTimer),o.progressTimer=null),"function"==typeof o.cleanup&&o.cleanup();const r=Math.max(0,Math.round((Date.now()-o.startTime)/1e3)),i=o.videoInfo.durationSeconds;i&&i>0&&Math.min(100,Math.round(r/i*100)),t.activeSession=null}function i(n,o,r){const i={page_name:t.title||void 0,page_url:e.location.href,video_id:n.id,video_title:n.title,video_url:n.url,video_provider:"youtube",video_duration_seconds:n.durationSeconds||void 0,lightbox_label:n.label||void 0,trigger_label:o?.getAttribute?.("aria-label")||o?.textContent?.trim()||void 0,timestamp:(new Date).toISOString()};return r&&"object"==typeof r&&Object.assign(i,r),function(e){return Object.keys(e).forEach(t=>{void 0!==e[t]&&""!==e[t]||delete e[t]}),e}(i)}function s(t,n){"undefined"!=typeof console&&"function"==typeof console.log&&console.log("[video-tracking]",t,n),e.analytics&&"function"==typeof e.analytics.track&&e.analytics.track(t,n)}t.addEventListener("DOMContentLoaded",()=>{!function(){e.jQuery&&e.jQuery(".empty-state.w-dyn-empty").length&&e.jQuery(".section_related-items").hide();const n=t.querySelector("#basic-swiper");if(!n)return;const o=()=>{const t=()=>{if(void 0===e.Swiper)return"function"==typeof e.__UnifyLoadSwiper?void e.__UnifyLoadSwiper().then(t).catch(e=>console.warn("Failed to load Swiper bundle",e)):void console.error("Swiper library not found.");new Swiper("#basic-swiper",{slidesPerView:2.5,slidesPerGroup:1,grabCursor:!1,a11y:!1,spaceBetween:24,allowTouchMove:!0,navigation:{nextEl:"#right-button",prevEl:"#left-button"},breakpoints:{0:{slidesPerView:1,slidesPerGroup:1,spaceBetween:24},480:{slidesPerView:1.3,slidesPerGroup:1,spaceBetween:24},767:{slidesPerView:1.8,slidesPerGroup:1,spaceBetween:24},992:{slidesPerView:2.5,slidesPerGroup:1,spaceBetween:24}}})};t()};if("IntersectionObserver"in e){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(e.disconnect(),o())})},{rootMargin:"300px"});e.observe(n)}else o()}(),function(){if(!e.jQuery)return void console.error("jQuery missing for Plyr initialization.");const n=e.jQuery,o=Array.from(t.querySelectorAll(".plyr_component"));if(!o.length)return;const r=o=>{if("true"===o.dataset.plyrInitialized)return;if(!e.Plyr)return void console.error("Plyr library missing.");o.dataset.plyrInitialized="true";const r=n(o),i=new Plyr(r.find(".plyr_video")[0],{controls:["play","progress","current-time","mute","fullscreen"],resetOnEnd:!0,autoplay:!1,muted:!1});i.on("play",function(){e.analytics&&"function"==typeof e.analytics.track&&e.analytics.track("Video Played")}),setTimeout(()=>{i.paused||(i.pause(),r.removeClass("hide-cover"))},100),t.addEventListener("visibilitychange",function(){t.hidden&&i.pause()}),r.find(".plyr_cover").on("click",function(){i.play()}),i.on("ended",()=>{r.removeClass("hide-cover")}),i.on("play",()=>{n(".plyr_component").removeClass("hide-cover"),r.addClass("hide-cover");const e=n(".plyr--playing").closest(".plyr_component").not(r);e.length>0&&e.find(".plyr_pause-trigger")[0].click()}),r.find(".plyr_pause-trigger").on("click",function(){i.pause()}),i.on("ended",()=>{i.fullscreen.active&&i.fullscreen.exit()}),i.on("enterfullscreen",()=>{r.addClass("contain-video")}),i.on("exitfullscreen",()=>{r.removeClass("contain-video")}),n(".hero_preview-vid").on("click",function(){i.play(),r.addClass("hide-cover")}),n(".background-close").on("click",function(){i.pause(),r.removeClass("hide-cover")}),n(t).on("keydown",function(e){"Escape"!==e.key||i.paused||(n(".background-close").click(),i.pause(),r.removeClass("hide-cover"))})};if(r(o[0]),"IntersectionObserver"in e){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(e.unobserve(t.target),r(t.target))})},{rootMargin:"200px"});o.forEach(t=>e.observe(t))}else o.forEach(r)}(),function(){const c=Array.from(t.querySelectorAll(".home-lightbox.w-lightbox"));if(!c.length)return;const l={bqgbZlMSW1I:114},a={activeSession:null};c.forEach(c=>{const d=function(e){const t=e.querySelector(".w-json");if(!t)return null;let r;try{r=JSON.parse(t.textContent)}catch(e){return console.warn("Unable to parse Webflow lightbox JSON.",e),null}const i=Array.isArray(r.items)?r.items[0]:null;if(!i)return null;const s=i.url||i.originalUrl||"",c=i.html||"",l=function(e){try{return decodeURIComponent(e)}catch(t){return e}}(c),a=o(s)||o(c)||o(l);return a?{id:a,url:s||`https://www.youtube.com/watch?v=${a}`,width:i.width,height:i.height,label:n(e)}:null}(c);d&&d.id&&(d.durationSeconds=l[d.id]||function(e){const t=e.getAttribute("data-video-duration")||e.getAttribute("data-video-length");if(t){const e=parseInt(t,10);if(!Number.isNaN(e)&&e>0)return e}let n=e.querySelector(".plyr_explore-subtext");if(!n){const t=e.closest(".perplexity_vid")||e.closest(".pos-rel")||e.parentElement;n=t?t.querySelector(".plyr_explore-subtext"):null}const o=n?n.textContent:"";if(!o)return null;const r=o.trim().match(/(\d+)\s*:\s*(\d{2})/);if(r)return 60*parseInt(r[1],10)+parseInt(r[2],10);const i=o.trim().match(/(\d+)\s*min/i);return i?60*parseInt(i[1],10):null}(c),c.addEventListener("click",()=>{!function(n,o,c){const l=Date.now(),a=()=>{const d=t.querySelector(".w-lightbox-backdrop");d?function(n,o,c,l){r(l);const a={id:`${o.id}-${Date.now()}`,startTime:Date.now(),milestonesFired:new Set,progressTimer:null,ended:!1,videoInfo:o,triggerElement:c,cleanup:null};l.activeSession=a,s("Video Played",i(o,c,{video_stage:"start",watch_time_seconds:0,percent_watched:0,tracking_method:"lightbox_timer"})),function(t,n){const o=t.videoInfo.durationSeconds;if(!o||o<=0)return;const c=[25,50,75,100];t.progressTimer=e.setInterval(()=>{if(t.ended)return;const e=(Date.now()-t.startTime)/1e3,l=Math.min(100,Math.floor(e/o*100));c.forEach(c=>{l>=c&&!t.milestonesFired.has(c)&&(t.milestonesFired.add(c),s("Video Played",i(t.videoInfo,t.triggerElement,{video_stage:"progress",milestone:c,percent_watched:c,watch_time_seconds:Math.round(e),tracking_method:"lightbox_timer"})),100===c&&(s("Video Played",i(t.videoInfo,t.triggerElement,{video_stage:"end",completed:!0,percent_watched:100,watch_time_seconds:Math.round(o),tracking_method:"lightbox_timer"})),r(n)))})},1e3)}(a,l),function(e,n,o){const i=()=>r(o),s=e.querySelector(".w-lightbox-close");s&&s.addEventListener("click",i,{once:!0});const c=e=>{o.activeSession===n&&e.target&&"function"==typeof e.target.closest&&e.target.closest(".w-lightbox-backdrop")&&(e.target.closest(".w-lightbox-frame")||i())};t.addEventListener("click",c,!0);const l=e=>{"Escape"===e.key&&i()};t.addEventListener("keydown",l);const a=new MutationObserver(()=>{t.body.contains(e)||i()});a.observe(t.body,{childList:!0,subtree:!0}),n.cleanup=()=>{t.removeEventListener("click",c,!0),t.removeEventListener("keydown",l),a.disconnect(),s&&s.removeEventListener("click",i)}}(n,a,l)}(d,n,o,c):Date.now()-l<3e3&&e.requestAnimationFrame(a)};a()}(d,c,a)}))})}()})}(window,document);
